## О проекте

**SplitParty** — это командный проект, направленный на разработку современного приложения с удобной системой пользовательских аккаунтов. Основная цель проекта — создать понятный и безопасный пользовательский путь от первого запуска приложения до полноценного использования сервиса.

Проект фокусируется на качестве пользовательского опыта, логичной навигации и надёжной работе с пользовательскими данными. SplitParty разрабатывается по гибкой методологии Scrum и служит основой для дальнейшего расширения функциональности приложения.

---

## Команда и роли (Scrum)

### Даша Перова — Team Lead
- координация команды
- архитектурные решения
- интеграция фронтенда и бэкенда
- участие в разработке фронта и бэка
- контроль качества и соответствия ТЗ

### Лев Разоренов — Backend Developer
- серверная логика аутентификации
- работа с API
- обработка регистрации, входа и восстановления пароля
- валидация данных и безопасность
- взаимодействие с базой данных

### Полина Ситникова — UI/UX Designer + Frontend Developer
- дизайн экранов приложения
- проектирование пользовательских сценариев
- визуальная согласованность интерфейса
- реализация UI на фронтенде

### Даша Шаталова — Frontend Developer
- реализация экранов
- навигация между экранами
- работа с формами и состояниями
- интеграция с backend API

## Дизайн
### Визуальные характеристики:
- Цветовая палитра: Монохромная - чёрный, белый, серый
- Типографика: Системные шрифты Apple, четкая иерархия
- Компоненты: Карточки с закругленными углами, четкие разделители
- Анимации: Плавные переходы между экранами, feedback при действиях

### UI-компоненты:
- Кастомные кнопки с состояниями (active/disabled)
- Карточки мероприятий с информацией об участниках и датах
- Модальные окна для добавления данных

## Фронтенд-реализация
### Архитектура:
- MVVM-подход с использованием SwiftUI
- Навигация: Stack-based navigation с NavigationLink
- Состояние: @State для локальных данных, @Binding для связи между view


### Ключевые экраны:

#### 1. Авторизация и регистрация
- Поля ввода с динамической валидацией
- Переключение видимости пароля
- Сохранение сессии через токены
- Восстановление пароля с подтверждением по email

#### 2. Список мероприятий
- Grid-отображение карточек мероприятий
- Поиск по названиям и датам
- Сортировка по дате создания
- Добавление новых мероприятий

#### 3. Детали мероприятия
- Управление участниками (добавление/удаление)
- Переход к совместному плейлисту
- Навигация к общему счету
- Редактирование информации о мероприятии

#### 4. Общий счет
- Создание и редактирование чеков
- Добавление товаров с указанием цены и количества
- Автоматический расчет стоимости для каждого участника
- Отметка участия/неучастия в покупках

#### 5. Совместный плейлист
- Два режима: случайный и ручной
- Добавление треков по ссылкам
- Сохранение плейлистов локально
- Интеграция с Яндекс.Музыкой (через токен)

#### 6. Профиль пользователя
- Смена аватара (8 вариантов на выбор)
- Редактирование личной информации
- Просмотр истории трат
- Управление списком друзей

#### 7. Система друзей
- Поиск пользователей по нику
- Подписка/отписка от друзей
- Просмотр списка текущих подписок

## Бэкенд

### Архитектурные особенности:
- **Язык и фреймворк**: Python + FastAPI (асинхронная основа, автоматическая документация OpenAPI)
- **Архитектура**: Чистая слоистая архитектура — `models` (ORM), `schemas` (валидация), `auth` (безопасность), `utils` (вспомогательные функции)
- **Безопасность**: JWT-токены с ограниченным временем жизни, хеширование паролей через **Argon2** (устойчив к атакам по времени и перебору), обязательная email-верификация
- **База данных**: PostgreSQL через SQLAlchemy ORM с поддержкой внешних ключей и каскадного удаления



### Основные компоненты:

#### 1. Система аутентификации и регистрации
- Регистрация с проверкой уникальности email и nickname
- Генерация одноразового токена верификации (UUID4) с TTL из `.env`
- Отправка кода подтверждения через SMTP (с fallback-логированием при отсутствии настроек)
- Авторизация по email или nickname + пароль
- Обязательная верификация email перед входом
- Выдача JWT access-токена с payload `{"sub": user_id}`

#### 2. Управление мероприятиями (Gatherings)
- Создание мероприятий с админом и описанием
- Автоматическое добавление создателя в участники
- Присоединение других пользователей по ID
- Проверка участия при доступе к связанным ресурсам (чеки, плейлисты)

#### 3. Система общих чеков
- Добавление чеков в рамках мероприятия
- Гибкое описание: название + список позиций (название + цена)
- Привязка к пользователю, создавшему чек
- Отметка участия: пользователь выбирает, за какие позиции он платил
- Кнопка «Не участвовал» — сброс выбора
- Статус чека: `pending` / `completed` на основе наличия отметок
- Итоговый отчёт: кто сколько заплатил по каждому чеку

#### 4. Безопасность и валидация
- Все входящие данные проходят валидацию через Pydantic:
  - Email — строго по RFC
  - Nickname — 3–30 символов, латиница, цифры, `_`
  - Пароль — минимум 8 символов
- Защита от SQL-инъекций через ORM
- Использование `utcnow()` и временных зон для токенов
- Чувствительные данные (секреты, SMTP) загружаются из `.env`

#### 5. Расширяемость
- Готовая структура для добавления:
  - Плейлистов (таблицы, схемы, эндпоинты)
  - Друзей/подписок (связь `User`–`User`)
  - Локализации, уведомлений, фоновых задач (через Celery)
- Поддержка миграций (через Alembic — достаточно добавить)
- Легко подключить асинхронную отправку email или кэширование



### Технические детали:
- **ORM**: SQLAlchemy (Core + ORM), `future=True` для совместимости с async-миграциями
- **Хеширование**: `passlib` с `argon2` — современный, медленный, безопасный алгоритм
- **JWT**: библиотека `PyJWT`, алгоритм HS256, срок жизни — настраивается
- **Сессии**: stateless, каждый запрос проверяет токен
- **Ошибки**: унифицированные HTTP-статусы (400, 401, 403, 404)
- **Логирование**: консольный вывод токенов в dev-режиме (для удобства отладки)



### Документация и отладка:
- Автоматическая OpenAPI-документация по адресу `/docs`
- Все эндпоинты типизированы, с примерами вход/выход
- Примеры тел запросов генерируются из Pydantic-моделей
- Возможность тестирования прямо в браузере


